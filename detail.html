<!-- komik-detail.html -->
<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KOMIK.YYDZ - Baca Komik Online Terbaru</title>

<!-- SEO Meta -->
<meta name="description" content="KOMIK.YYDZ - Platform membaca komik online terbaru dan lengkap dari berbagai genre seperti Action, Romance, Fantasy, Horror, dan banyak lagi.">
<meta name="keywords" content="komik, manga, baca komik online, komik action, komik romance, komik fantasy, komik terbaru">
<meta name="author" content="Yudzxml">

<!-- Open Graph / Social Media Preview -->
<meta property="og:title" content="KOMIK.YYDZ - Baca Komik Online Terbaru">
<meta property="og:description" content="Platform membaca komik online terbaru dan lengkap dari berbagai genre. Temukan komik favoritmu sekarang!">
<meta property="og:type" content="website">
<meta property="og:url" content="https://komik.yydz.x-server.web.id">
<meta property="og:image" content="https://raw.githubusercontent.com/Yudzxml/UploaderV2/main/tmp/554829fc.png">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="KOMIK.YYDZ - Baca Komik Online Terbaru">
<meta name="twitter:description" content="Platform membaca komik online terbaru dan lengkap dari berbagai genre. Temukan komik favoritmu sekarang!">
<meta name="twitter:image" content="https://raw.githubusercontent.com/Yudzxml/UploaderV2/main/tmp/554829fc.png">

<!-- Fonts & Icons -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<!-- Favicon -->
<link rel="icon" href="https://raw.githubusercontent.com/Yudzxml/UploaderV2/main/tmp/554829fc.png" type="image/x-icon">
</head>
<style>
/* Reset & Font */
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: 'Poppins', sans-serif;
  background: linear-gradient(160deg, #1e3c72, #2a5298);
  color: #f0f0f0;
  padding: 20px;
  transition: all 0.3s ease;
}

/* Judul */
h1 {
  text-align: center;
  font-size: 3rem;
  margin-bottom: 30px;
  color: #fff;
  text-shadow: 2px 2px 10px rgba(0,0,0,0.5);
  letter-spacing: 1px;
}

/* Form pencarian */
form {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 10px;
  margin-bottom: 40px;
}
input[type="text"] {
  flex: 1;
  max-width: 400px;
  padding: 14px 20px;
  font-size: 16px;
  border-radius: 50px;
  border: none;
  outline: none;
  background: rgba(255,255,255,0.15);
  color: #fff;
  backdrop-filter: blur(8px);
  box-shadow: inset 0 0 10px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
}
input[type="text"]::placeholder { color: #ddd; }
input[type="text"]:focus { box-shadow: inset 0 0 15px rgba(255,255,255,0.4); }
button {
  padding: 14px 25px;
  font-size: 16px;
  border-radius: 50px;
  border: none;
  cursor: pointer;
  background: linear-gradient(135deg, #ff416c, #ff4b2b);
  color: #fff;
  font-weight: 600;
  transition: all 0.3s ease;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}
button:hover {
  transform: translateY(-3px) scale(1.05);
  box-shadow: 0 10px 20px rgba(0,0,0,0.5);
}

.bookmark-container {
  text-align: center;
  margin: 15px 0;
}

.bookmark-btn {
  font-size: 22px;
  padding: 10px 25px;
  border-radius: 50px;
  border: none;
  cursor: pointer;
  background: linear-gradient(135deg, #ff416c, #ff4b2b);
  color: #fff;
  transition: all 0.3s ease;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}

.bookmark-btn:hover {
  transform: translateY(-2px) scale(1.05);
  box-shadow: 0 8px 20px rgba(0,0,0,0.5);
}

/* Thumbnail */
#image {
  width: 100%;
  max-height: 450px;
  object-fit: cover;
  border-radius: 20px;
  margin-bottom: 20px;
  transition: transform 0.3s;
}
#image:hover { transform: scale(1.02); }

/* Meta & Synopsis */
.meta p, .synopsis p { margin: 8px 0; line-height: 1.6; color: #ddd; }
.synopsis h3 { margin-bottom: 10px; color: #fff; }

/* Chapter Controls */
.chapter-controls {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin: 20px 0;
  flex-wrap: wrap;
  gap: 10px;
}
.chapter-controls input {
  flex: 1;
  min-width: 200px;
}
.chapter-controls button { flex-shrink: 0; }

/* Chapters List */
.chapters {
  display: flex;
  flex-direction: column;
  border-radius: 15px;
  max-height: 400px;
  overflow-y: auto;
  border: 1px solid rgba(255,255,255,0.1);
  backdrop-filter: blur(8px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}
.chapter-header, .chapter-row {
  display: flex;
  justify-content: space-between;
  padding: 12px 15px;
  transition: all 0.3s ease;
}
.chapter-header {
  font-weight: bold;
  background: rgba(255,255,255,0.1);
  border-bottom: 2px solid #ff416c;
  border-radius: 15px 15px 0 0;
}
.chapter-row {
  cursor: pointer;
  border-bottom: 1px solid rgba(255,255,255,0.05);
}
.chapter-row:hover { background: rgba(255,255,255,0.08); }
.chapter-row div { flex: 1; text-align: left; }
.chapter-row div.views, .chapter-row div.date { flex: 0.8; text-align: center; }
.chapter-row div.no { flex: 0.5; text-align: center; }
.highlight { background: rgba(255,65,108,0.3) !important; }

/* Scrollbar */
.chapters::-webkit-scrollbar {
  width: 8px;
}
.chapters::-webkit-scrollbar-track {
  background: rgba(255,255,255,0.05);
  border-radius: 10px;
}
.chapters::-webkit-scrollbar-thumb {
  background: rgba(255,65,108,0.6);
  border-radius: 10px;
}

/* Genre Buttons */
.genre-buttons {
  text-align: center;
  margin: 30px 0;
}
.genre-buttons button {
  background: rgba(255,255,255,0.1);
  color: #fff;
  margin: 5px;
  padding: 10px 20px;
  border-radius: 25px;
  font-size: 14px;
  font-weight: 500;
  border: 1px solid rgba(255,255,255,0.3);
  transition: all 0.3s ease;
}
.genre-buttons button:hover {
  background: linear-gradient(135deg, #ff416c, #ff4b2b);
  transform: translateY(-2px) scale(1.05);
}

/* Footer */
.footer {
  text-align: center;
  padding: 25px 20px;
  margin-top: 50px;
  color: #ddd;
  font-size: 14px;
  background: rgba(255,255,255,0.05);
  border-top: 1px solid rgba(255,255,255,0.1);
  backdrop-filter: blur(10px);
  border-radius: 15px 15px 0 0;
  box-shadow: 0 -5px 15px rgba(0,0,0,0.2);
}
.footer a { color: #ff416c; margin: 0 10px; transition: all 0.3s ease; font-size: 20px; }
.footer a:hover { color: #ff4b2b; transform: scale(1.2); }
.footer p { margin: 5px 0; }

.bottom-menu {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background: rgba(30, 60, 114, 0.95);
  display: flex;
  justify-content: space-around;
  padding: 10px 0;
  border-top: 1px solid rgba(255,255,255,0.1);
  backdrop-filter: blur(10px);
  z-index: 1000;
  box-shadow: 0 -5px 15px rgba(0,0,0,0.3);
  border-radius: 15px 15px 0 0;
}

.bottom-menu a {
  text-decoration: none;
  color: #fff;
  font-size: 14px;
  display: flex;
  flex-direction: column;
  align-items: center;
  transition: all 0.3s ease;
}

.bottom-menu a i {
  font-size: 20px;
  margin-bottom: 3px;
}

.bottom-menu a:hover {
  color: #ff416c;
  transform: scale(1.1);
}

/* Responsif */
@media(max-width: 768px) {
  input[type="text"] { width: 80%; }
  h1 { font-size: 2rem; }
  .chapter-controls { flex-direction: column; gap: 10px; }
}
</style>
<body>
<div class="container">
<h1 style="text-align: center;">
  <img 
    src="https://raw.githubusercontent.com/Yudzxml/UploaderV2/main/tmp/e8193fb7.png" 
    alt="Logo KOMIK.YYDZ" 
    style="display: block; margin: 0 auto; width: 200px; height: auto;"
  >
  KOMIK.YYDZ
</h1>
  <form id="searchForm">
    <input type="text" id="query" placeholder="Masukkan nama komik..." required>
    <button type="submit">Cari</button>
  </form>
  <h1 id="title">Loading...</h1>
  <img id="image" src="" alt="Thumbnail">
<div class="bookmark-container">
  <button id="bookmarkBtn" class="bookmark-btn">★ Tambahkan ke Bookmark</button>
</div>
  <div class="meta" id="meta"></div>
  <div class="synopsis" id="synopsis"></div>

  <div class="chapter-controls">
    <input type="text" id="searchInput" placeholder="Cari chapter...">
    <button id="readFirst">Baca Chapter 1</button>
  </div>

  <div class="chapters" id="chapters">
    <div class="chapter-header">
      <div class="no">No</div>
      <div class="title">Judul Chapter</div>
      <div class="views">Views</div>
      <div class="date">Tanggal</div>
    </div>
  </div>

  <div class="genre-buttons" id="genreButtons"></div>

  <footer class="footer">
    <p>© 2025 <strong>KOMIK.YYDZ</strong>. Semua hak cipta dilindungi.</p>
    <p>
      <a href="https://wa.me/6283872031397" target="_blank"><i class="fab fa-whatsapp"></i></a>
      <a href="https://t.me/Yudzxzy" target="_blank"><i class="fab fa-telegram-plane"></i></a>
      <a href="mailto:yudaaryaardhana1122@email.com" target="_blank"><i class="fas fa-envelope"></i></a>
    </p>
    <p>Desain & Pengembangan oleh <a href="#" target="_blank">Yudzxml</a></p>
  </footer>
</div>

<!-- Bottom Menu -->
<nav class="bottom-menu">
  <a href="index.html" title="Beranda"><i class="fas fa-home"></i><span>Beranda</span></a>
  <a href="bookmark.html" title="Bookmark"><i class="fas fa-bookmark"></i><span>Bookmark</span></a>
  <a href="akun.html" title="Akun"><i class="fas fa-user"></i><span>Akun</span></a>
  <a href="search.html" title="Cari"><i class="fas fa-search"></i><span>Cari</span></a>
</nav>

<script>
const params = new URLSearchParams(window.location.search);
const komikUrl = params.get('url');

const chaptersContainer = document.getElementById('chapters');
const searchInput = document.getElementById('searchInput');
const readFirstBtn = document.getElementById('readFirst');
const titleEl = document.getElementById('title');
const imageEl = document.getElementById('image');
const genreButtonsContainer = document.getElementById('genreButtons');
const searchForm = document.getElementById('searchForm');

let chaptersList = [];
let lastOpenedChapter = null;
let lastThumbnail = null;
const lastSessionKey = `lastChapter_${komikUrl}`;
const lastThumbnailKey = `lastThumbnail_${komikUrl}`;

// Ambil sesi terakhir
if(localStorage.getItem(lastSessionKey)) lastOpenedChapter = JSON.parse(localStorage.getItem(lastSessionKey));
if(localStorage.getItem(lastThumbnailKey)) { lastThumbnail = localStorage.getItem(lastThumbnailKey); imageEl.src = lastThumbnail; }

// Form pencarian
searchForm.addEventListener('submit', e => {
  e.preventDefault();
  const query = document.getElementById('query').value.trim();
  if(query) window.location.href = `search.html?query=${encodeURIComponent(query)}`;
});

const genres = [
    "action", "adult", "adventure", "comedy", "cooking", "crime", "demons",
    "drama", "ecchi", "fantasy", "game", "gender-bender", "ghosts", "gore",
    "harem", "historical", "horror", "isekai", "josei", "magic", "manga",
    "martial-arts", "mature", "mecha", "medical", "military", "monsters",
    "music", "mystery", "one-shot", "police", "psychological",
    "reincarnation", "romance", "school", "school-life", "sci-fi", "seinen",
    "shoujo", "shoujo-ai", "shounen", "shounen-ai", "slice-of-life", "sport",
    "sports", "super-power", "supernatural", "thriller", "tragedy",
    "villainess", "yuri"
];
genres.forEach(g => {
  const btn = document.createElement('button');
  btn.textContent = g.charAt(0).toUpperCase()+g.slice(1);
  btn.addEventListener('click', () => window.location.href=`genre.html?genre=${encodeURIComponent(g)}&page=1`);
  genreButtonsContainer.appendChild(btn);
});

async function fetchDetail() {
  if(!komikUrl){ titleEl.innerText='❌ Tidak ada komik yang dipilih.'; return; }

  try {
    const res = await fetch(`https://api-yudzxzy.vercel.app/api/search/komiku?action=detail&url=${encodeURIComponent(komikUrl)}`);
    const data = await res.json();

    if(data.status && data.data){
      const meta = data.data.info;
      chaptersList = data.data.chapters.slice().reverse();
      window.sessionStorage.setItem('chapterList', JSON.stringify(chaptersList));

      titleEl.innerText = data.data.title;
      imageEl.src = data.data.image;
      localStorage.setItem(lastThumbnailKey, data.data.image);

      document.getElementById('meta').innerHTML = `
        <p><strong>Judul ID:</strong> ${data.data.title_id}</p>
        <p><strong>Jenis:</strong> ${meta.jenis}</p>
        <p><strong>Konsep:</strong> ${meta.konsep}</p>
        <p><strong>Pengarang:</strong> ${meta.pengarang}</p>
        <p><strong>Status:</strong> ${meta.status || "N/A"}</p>
        <p><strong>Umur Pembaca:</strong> ${meta.umur_pembaca}</p>
        <p><strong>Cara Baca:</strong> ${meta.cara_baca}</p>
        <p><strong>Genre:</strong> ${meta.genres.join(', ')}</p>
      `;
      document.getElementById('synopsis').innerHTML = `<h3>Sinopsis:</h3><p>${data.data.sinopsis_lengkap}</p>`;

      renderChapters(chaptersList);
    } else titleEl.innerText='❌ Data komik tidak ditemukan.';
  } catch(err) {
    console.error(err);
    titleEl.innerText='⚠️ Terjadi kesalahan saat mengambil data.';
  }
}

const bookmarkBtn = document.getElementById('bookmarkBtn');
const bookmarkKey = 'komikBookmarks';

function updateBookmarkBtn() {
  const bookmarks = JSON.parse(localStorage.getItem(bookmarkKey)) || [];
  const exists = bookmarks.some(k => k.url === komikUrl);
  if(exists){
    bookmarkBtn.innerText = '★ Sudah di Bookmark';
    bookmarkBtn.style.color = 'gold';
  } else {
    bookmarkBtn.innerText = '★ Tambahkan ke Bookmark';
    bookmarkBtn.style.color = '#fff';
  }
}


bookmarkBtn.addEventListener('click', () => {
  let bookmarks = JSON.parse(localStorage.getItem(bookmarkKey)) || [];
  const exists = bookmarks.some(k => k.url === komikUrl);

  if(exists){
    bookmarks = bookmarks.filter(k => k.url !== komikUrl);
  } else {
    bookmarks.push({
      title: titleEl.innerText,
      thumb: imageEl.src,
      url: komikUrl,
      date: Date.now()
    });
  }
  localStorage.setItem(bookmarkKey, JSON.stringify(bookmarks));
  updateBookmarkBtn();
});

updateBookmarkBtn();

function renderChapters(list){
  chaptersContainer.querySelectorAll('.chapter-row').forEach(r=>r.remove());
  list.forEach((ch,i)=>{
    const row=document.createElement('div');
    row.className='chapter-row';
    row.innerHTML=`
      <div class="no">${i+1}</div>
      <div class="title">${ch.title}</div>
      <div class="views">${ch.views}</div>
      <div class="date">${ch.date}</div>
    `;
    row.addEventListener('click',()=>{
      window.open(`chapter.html?url=${encodeURIComponent(ch.link)}`,'_blank');
      localStorage.setItem(lastSessionKey, JSON.stringify({index:i,link:ch.link}));
    });
    if(lastOpenedChapter && lastOpenedChapter.link===ch.link){
      row.classList.add('highlight');
      setTimeout(()=>row.scrollIntoView({behavior:'smooth', block:'center'}),50);
    }
    chaptersContainer.appendChild(row);
  });
}

searchInput.addEventListener('input',()=>{
  const query = searchInput.value.toLowerCase();
  renderChapters(chaptersList.filter(ch=>ch.title.toLowerCase().includes(query)));
});

readFirstBtn.addEventListener('click',()=>{
  if(chaptersList.length>0){
    window.open(`chapter.html?url=${encodeURIComponent(chaptersList[0].link)}`,'_blank');
    localStorage.setItem(lastSessionKey, JSON.stringify({index:0,link:chaptersList[0].link}));
  }
});

fetchDetail();
</script>
</body>
</html>